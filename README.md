# Использование провайдера терраформа\тофу для создания виртуальных машин.
## Описание
Шаблон для создания ВМ используя terraform\OpenTofu.
Данный шаблон позволет провести деплой виртуальных машин вместе с установленой ОС Ubuntu 22.04. Для использования требуется провайдер bpg\proxmox.
### Описание рабочего каталога. 
Рабочий каталог содержит файлы provider.tf, template.tf, ubuntu_cloud_config.tf, variables.tf. В файле provider.tf содержится информация об используемых провайдерах т.е. какие функции в апи мы будем использовать для взимодействия с гипервизором. Так же для удобства и разграничения конфигов мы можем указать в данном файле учетные данные для доступа к гипервизору. Это позволит зоны ответственности по разным файлам. 
К сожалению реджистри (хранилище провайдеров) терраформа и опентофу недоступны на территории РФ, поэтому требуется создать файл tofurc (или terraformrc) и указать зеркала доступные из РФ. Для подробностей [статья] (https://dev.to/kvendingoldo/kak-nastroit-zierkalo-rieiestrov-dlia-opentofu-i-terraform-277k)
Файл template.tf содержит основные настройки и параметры системы. Исполнение этого файла создает и настраивает ВМ со стороны гипервизора (ЦПУ, диск, RAM и т. д.). Для подробностей смотреть коментарии к каждому параметру внутри файла. 
Файл ubuntu_cloud_config.tf нужен для генераци облачного конфига которые настроит нашу ВМ изнутри (Логин пароль, ssh-ключи и т.д.). Для подробностей смотреть коментарии к каждому параметру внутри файла.
Файл variables.tf нужен для объявления и настройки переменных. Перед использованием переменной в terraform ее нужно объявить, указать ее тип, описание и значение по умолчанию.
### Требуется создать
Файл настроек зеркала реджистри для провайдера, так как оригинальный реджистри недоступен из РФ. Данный файл создается в домашнем каталоге пользователя, который будет выполнять манифесты.
Имя файла .tofurc (или .terraformrc). 
Файл содержащий значения для объявленных переменных values.tfvars. Данный файл соержит значения для объявленных переменных. Файл содержит чувствительную информацию и не должен храниться в открытом виде. (А лучше вообще не хранить).
